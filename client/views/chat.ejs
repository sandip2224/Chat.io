<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://kit.fontawesome.com/0a7cb7270a.js" crossorigin="anonymous"></script>

    <link rel="icon" type="image/x-icon" href="assets/chat.png">
    <title>Chat.io</title>
</head>

<body>
    <div class="chat-container">
        <header class="chat-header">
            <h1><i class="fas fa-solid fa-comments"></i> Chat.io</h1>
            <p id="typing"></p>
            <p id="user-name"></p>
            <p id="vapid-public"></p>
            <p id="base-url"></p>
            <a href="/" class="btn"><i class="fa fa-solid fa-right-from-bracket"></i> Leave</a>
        </header>
        <main class="chat-main">
            <div class="chat-sidebar">
                <h3 id="room-name-header"><i class="fas fa-comments"></i>
                    Room Name
                </h3>
                <h2 id="room-name"></h2>
                <h3 id="user-list-header"><i class="fas fa-users"></i> Users</h3>
                <ul id="users"></ul>
            </div>
            <div class="chat-messages">
                <%chats.forEach(chat=>{%>
                    <%if(chat.room===roomVal){%>
                        <div class="message">
                            <p class="meta">
                                <%=chat.username%><span>&nbsp;&nbsp;&nbsp;&nbsp;<%=chat.time%></span>
                            </p>
                            <p class="text"><%=chat.message%></p>
                        </div>
                        <%}%>
                    <%})%>
            </div>
        </main>
        <div class="chat-form-container">
            <form id="chat-form">
                <div class="d1">
                    <input id="msg" type="text" placeholder=" Enter message..." autocomplete="off" onkeypress="onkeyFn()" required />
                </div>
                <div class="d2">
                    <button class="btn tooltip"><i class="fas fa-paper-plane"></i><span class="tooltiptext">Send message</span></button>
                    <button class="btn btn1 tooltip" onclick="subscribe()"><i class="fas fa-solid fa-bell"></i><span class="tooltiptext">Subscribe to room notifications</span></button>
                    <button class="btn btn2 tooltip" onclick="unsubscribe()"><i class="fas fa-solid fa-bell-slash"></i><span class="tooltiptext">Unsubscribe from room notifications</span></button>
                </div>
            </form>
        </div>
    </div>
    <script>
        document.getElementById('room-name').innerHTML=<%-JSON.stringify(roomVal) %>
        document.getElementById('user-name').innerHTML=<%-JSON.stringify(userVal) %>
        document.getElementById('vapid-public').innerHTML=<%-JSON.stringify(vapidPublic) %>
        document.getElementById('base-url').innerHTML=<%-JSON.stringify(baseUrl) %>
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.10.1/qs.min.js"
        integrity="sha512-aTKlYRb1QfU1jlF3k+aS4AqTpnTXci4R79mkdie/bp6Xm51O5O3ESAYhvg6zoicj/PD6VYY0XrYwsWLcvGiKZQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/socket.io/socket.io.js"></script>

    <script src="js/main.js"></script>
    <script src="js/push_script.js"></script>
</body>

</html>